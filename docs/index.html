<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Downloads and Organizes Financial Data from Yahoo Finance • yfR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Downloads and Organizes Financial Data from Yahoo Finance">
<meta name="description" content="Facilitates download of financial data from Yahoo Finance &lt;https://finance.yahoo.com/&gt;, a vast repository of stock price data across multiple financial exchanges. The package offers a local caching system and support for parallel computation.">
<meta property="og:description" content="Facilitates download of financial data from Yahoo Finance &lt;https://finance.yahoo.com/&gt;, a vast repository of stock price data across multiple financial exchanges. The package offers a local caching system and support for parallel computation.">
<meta property="og:image" content="https://msperlin.github.io/yfR/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">yfR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/diff-batchgetsymbols.html">yfR and BatchGetSymbols</a></li>
    <li><a class="dropdown-item" href="articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="articles/using-collections.html">Using Collections</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/yfR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h1>
</div>
<p><code>yfR</code> facilitates importing stock prices from Yahoo finance, organizing the data in the <code>tidy</code> format and speeding up the process using a cache system and parallel computing. <code>yfR</code> is the second and backwards-incompatible version of <a href="https://CRAN.R-project.org/package=BatchGetSymbols" class="external-link">BatchGetSymbols</a>, released in 2016 (see vignette <a href="https://docs.ropensci.org/yfR/articles/diff-batchgetsymbols.html" class="external-link">yfR and BatchGetSymbols</a> for details).</p>
<p>In a nutshell, <a href="https://finance.yahoo.com/" class="external-link">Yahoo Finance (YF)</a> provides a vast repository of stock price data around the globe. It covers a significant number of markets and assets, being used extensively in academic research and teaching. In order to import the financial data from YF, all you need is a ticker (id of a stock, e.g. “GM” for <a href="https://finance.yahoo.com/quote/GM?p=GM&amp;.tsrc=fin-srch" class="external-link">General Motors</a>) and a time period – first and last date.</p>
</div>
<div class="section level1">
<h1 id="the-data">The Data<a class="anchor" aria-label="anchor" href="#the-data"></a>
</h1>
<p>The main function of the package, <code><a href="reference/yf_get.html">yfR::yf_get</a></code>, returns a dataframe with the financial data. All price data is measured at the unit of the financial exchange. For example, price data for GM (NASDAQ/US) is measured in dollars, while price data for PETR3.SA (B3/BR) is measured in Reais (Brazilian currency).</p>
<p>The returned data contains the following columns:</p>
<p><strong>ticker</strong>: The requested tickers (ids of stocks);</p>
<p><strong>ref_date</strong>: The reference day (this can also be year/month/week when using argument freq_data);</p>
<p><strong>price_open</strong>: The opening price of the day/period;</p>
<p><strong>price_high</strong>: The highest price of the day/period;</p>
<p><strong>price_close</strong>: The close/last price of the day/period;</p>
<p><strong>volume</strong>: The financial volume of the day/period, in the unit of the exchange;</p>
<p><strong>price_adjusted</strong>: The stock price adjusted for corporate events such as splits, dividends and others – this is usually what you want/need for studying stocks as it represents the real financial performance of stockholders;</p>
<p><strong>ret_adjusted_prices</strong>: The arithmetic or log return (see input type_return) for the adjusted stock prices;</p>
<p><strong>ret_adjusted_prices</strong>: The arithmetic or log return (see input type_return) for the closing stock prices;</p>
<p><strong>cumret_adjusted_prices</strong>: The accumulated arithmetic/log return for the period (starts at 100%).</p>
</div>
<div class="section level1">
<h1 id="finding-tickers">Finding tickers<a class="anchor" aria-label="anchor" href="#finding-tickers"></a>
</h1>
<p>The easiest way to find the tickers of a company stock is to search for it in <a href="https://finance.yahoo.com/" class="external-link">Yahoo Finance’s</a> website. At the top page you’ll find a search bar:</p>
<figure><img src="/inst/figures/search-yf.png?raw=true" title="Example of search in YF" alt="YF Search"><figcaption aria-hidden="true">
YF Search
</figcaption></figure><p>A company can have many different stocks traded at different markets (see picture above). As the example shows, Petrobras is traded at NYQ (New York Exchange), SAO (Sao Paulo/Brazil - B3 exchange) and BUE (Buenos Aires/Argentina Exchange), all with different symbols (tickers). For market indices, a list of tickers is available <a href="https://finance.yahoo.com/world-indices" class="external-link">here</a>.</p>
<div class="section level2">
<h2 id="features-of-yfr">Features of <code>yfR</code>
<a class="anchor" aria-label="anchor" href="#features-of-yfr"></a>
</h2>
<ul>
<li><p>Fetches daily/weekly/monthly/annual stock prices/returns from yahoo finance and outputs a dataframe (tibble) in the long format (stacked data);</p></li>
<li><p>A new feature called <strong>collections</strong> facilitates download of multiple tickers from a particular market/index. You can, for example, download data for all stocks in the SP500 index with a simple call to <code>yf_collection_get("SP500")</code>;</p></li>
<li><p>A session-persistent smart cache system is available by default. This means that the data is saved locally and only missing portions are downloaded, if needed.</p></li>
<li><p>All dates are compared to a benchmark ticker such as SP500 and, whenever an individual asset does not have a sufficient number of dates, the software drops it from the output. This means you can choose to ignore tickers with a high proportion of missing dates.</p></li>
<li><p>A customized function called <code><a href="reference/yf_convert_to_wide.html">yf_convert_to_wide()</a></code> can transform the long dataframe into a wide format (tickers as columns), much used in portfolio optimization. The output is a list where each element is a different target variable (prices, returns, volumes).</p></li>
<li><p>Parallel computing with package <code>furrr</code> is available, speeding up the data importation process.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="warnings">Warnings<a class="anchor" aria-label="anchor" href="#warnings"></a>
</h2>
<ul>
<li>Yahoo finance data is far from perfect or reliable, specially for individual stocks. In my experience, using it for research code with stock <strong>indices</strong> is fine and I can match it with other data sources. But, adjusted stock prices for <strong>individual assets</strong> is messy as stock events such as splits or dividends are not properly registered. I was never able to match it with other data sources, specially for long time periods with lots of corporate events. My advice is to <strong>never use the yahoo finance data of individual stocks in production</strong> (research papers or academic documents – thesis and dissertations). If adjusted price data of individual stocks is important for your research, <strong>use other data sources</strong> such as <a href="https://eodhd.com/" class="external-link">EODHD</a>, <a href="https://www.simfin.com/" class="external-link">SimFin</a> or <a href="https://www.economatica.com/" class="external-link">Economática</a>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># CRAN (stable)</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'yfR'</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># Github (dev version)</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">'ropensci/yfR'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># ropensci</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"yfR"</span>, <span class="at">repos =</span> <span class="st">"https://ropensci.r-universe.dev"</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-simple-example-of-usage">A simple example of usage<a class="anchor" aria-label="anchor" href="#a-simple-example-of-usage"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/yfR" class="external-link">yfR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set options for algorithm</span></span>
<span><span class="va">my_ticker</span> <span class="op">&lt;-</span> <span class="st">'META'</span></span>
<span><span class="va">first_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">30</span></span>
<span><span class="va">last_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fetch data</span></span>
<span><span class="va">df_yf</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/yf_get.html">yf_get</a></span><span class="op">(</span>tickers <span class="op">=</span> <span class="va">my_ticker</span>, </span>
<span>                     first_date <span class="op">=</span> <span class="va">first_date</span>,</span>
<span>                     last_date <span class="op">=</span> <span class="va">last_date</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Running yfR for 1 stocks | 2025-04-19 --&gt; 2025-05-19 (30 days) ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Downloading data for benchmark ticker ^GSPC</span></span>
<span><span class="co">#&gt; ℹ (1/1) Fetching data for META</span></span>
<span><span class="co">#&gt; !    - not cached</span></span>
<span><span class="co">#&gt; ✔    - cache saved successfully</span></span>
<span><span class="co">#&gt; ✔    - got 20 valid rows (2025-04-21 --&gt; 2025-05-16)</span></span>
<span><span class="co">#&gt; ✔    - got 100% of valid prices -- Time for some tea?</span></span>
<span><span class="co">#&gt; ℹ Binding price data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Diagnostics ─────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; ✔ Returned dataframe with 20 rows -- All OK!</span></span>
<span><span class="co">#&gt; ℹ Using 5.9 kB at /tmp/Rtmpcyyijl/yf_cache for 2 cache files</span></span>
<span><span class="co">#&gt; ℹ Out of 1 requested tickers, you got 1 (100%)</span></span>
<span></span>
<span><span class="co"># output is a tibble with data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_yf</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 11</span></span>
<span><span class="co">#&gt;   ticker ref_date   price_open price_high price_low price_close   volume</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;  &lt;date&gt;          &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 META   2025-04-21       491.       494.      480.        485. 16166000</span></span>
<span><span class="co">#&gt; 2 META   2025-04-22       492.       507.      486.        500. 17399400</span></span>
<span><span class="co">#&gt; 3 META   2025-04-23       529.       535.      517.        520. 18173900</span></span>
<span><span class="co">#&gt; 4 META   2025-04-24       519.       534.      518.        533. 13910000</span></span>
<span><span class="co">#&gt; 5 META   2025-04-25       547.       550.      536.        547. 17098900</span></span>
<span><span class="co">#&gt; 6 META   2025-04-28       556.       558.      541.        550. 15179000</span></span>
<span><span class="co">#&gt; # ℹ 4 more variables: price_adjusted &lt;dbl&gt;, ret_adjusted_prices &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   ret_closing_prices &lt;dbl&gt;, cumret_adjusted_prices &lt;dbl&gt;</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h1>
<p>Package <code>yfR</code> is based on <a href="https://www.quantmod.com/" class="external-link">quantmod</a> (@joshuaulrich) and uses one of its functions (<code><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.html" class="external-link">quantmod::getSymbols</a></code>) for fetching raw data from Yahoo Finance. As with any API, there is significant work in maintaining the code. Joshua was always fast and openminded in implemented required changes, and I’m very grateful for it.</p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=yfR" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/ropensci/yfR/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ropensci/yfR/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing yfR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Marcelo Perlin <br><small class="roles"> Author, maintainer </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://app.codecov.io/gh/ropensci/yfR?branch=main" class="external-link"><img src="https://codecov.io/gh/ropensci/yfR/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/ropensci/yfR/actions" class="external-link"><img src="https://github.com/ropensci/yfR/workflows/R-CMD-check/badge.svg" alt="R build (rcmdcheck)"></a></li>
<li><a href="https://github.com/ropensci/software-review/issues/523" class="external-link"><img src="https://badges.ropensci.org/523_status.svg" alt="Status at rOpenSci Software Peer Review"></a></li>
<li><a href="https://github.com/ropensci/yfR/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/ropensci/yfR/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marcelo Perlin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
